<form action="{% url 'voxpopulirecipes:submit_recipe' %}" method="post">
    {% csrf_token %}
    <fieldset>
        <legend><h1>Create a new recipe</h1></legend>
        <label for="id_title">Recipe Name:</label>
        <input type="text" name="title" id="id_title" required>

        <fieldset id="ingredients-section">
            <legend>Ingredients</legend>
            <div class="ingredient">
                <input type="text" name="ingredient_amount_1" placeholder="Amount" required>
                <input type="text" name="ingredient_unit_1" placeholder="Unit" required>
                <input type="text" name="ingredient_text_1" placeholder="Ingredient" required>
            </div>
        </fieldset>

        <button type="button" id="add-ingredient">Add another ingredient</button>

        <fieldset id="instructions-section">
        <div class="instruction">
            <input type="text" name="instruction_text_1" placeholder="Instruction" required>
        </div>

        <button type="button" id="add-instruction">Add another instruction</button>
        </fieldset>
    </fieldset>
    <input type="submit" value="Publish">
</form>

<script>
    // on page load, create the event listeners and set up incrementing ingredient count
    document.addEventListener("DOMContentLoaded", function() {
        let ingredientCount = 1;
        let instructionCount = 1;

        // add a listener for the add ingredient button
        document.getElementById("add-ingredient").addEventListener("click", function() {
            ingredientCount++;

            // onclick of add ingredient button, make a new div and set the class
            const ingredientDiv = document.createElement("div");
            ingredientDiv.classList.add("ingredient");

            // set the content of the new div using the ingredient count so each set has its own unique names
            ingredientDiv.innerHTML = `
                <input type="text" name="ingredient_amount_${ingredientCount}" placeholder="Amount" required>
                <input type="text" name="ingredient_unit_${ingredientCount}" placeholder="Unit" required>
                <input type="text" name="ingredient_text_${ingredientCount}" placeholder="Ingredient" required>
            `;

            // append to the ingredient section
            document.getElementById("ingredients-section").appendChild(ingredientDiv);
        });

        // basically does the same thing but for instructions
        document.getElementById("add-instruction").addEventListener("click", function() {
            instructionCount++;

            const instructionDiv = document.createElement("div");
            instructionDiv.classList.add("instruction");

            instructionDiv.innerHTML = `
                <input type="text" name="instruction_text_${instructionCount}" placeholder="Instruction" required>
            `;

            document.getElementById("instructions-section").appendChild(instructionDiv);
        });
    });
</script>